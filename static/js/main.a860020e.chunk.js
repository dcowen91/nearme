(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{27:function(e,t,n){e.exports=n(60)},32:function(e,t,n){},33:function(e,t,n){},60:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(3),s=n.n(r),c=(n(32),n(19)),l=n(20),o=n(25),u=n(21),d=n(26),m=(n(33),n(4)),p=n(9),h=n.n(p),g=n(62),f=n(10),I=n(23),v=Object(m.c)({accessToken:"pk.eyJ1IjoiZGNvd2VuOTEiLCJhIjoiY2o4amwxazg5MDNmdDJ2anNmMTNiaThzeSJ9.JcuyCdKas70Xq8RDme7hCw"}),y=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(o.a)(this,Object(u.a)(t).call(this,e))).debouncedGetArticles=Object(g.a)(n.getArticles,500),n.state={latitude:47.6072062,longitude:-122.3350407,showErrorDialog:!1,selectedItemIndex:-1,items:[],menuOpen:!1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;navigator.geolocation.getCurrentPosition(function(t){e.setState({latitude:t.coords.latitude,longitude:t.coords.longitude}),e.getArticles()},function(){e.setState({showErrorDialog:!0})})}},{key:"componentDidUpdate",value:function(e,t){t.latitude===this.state.latitude&&t.longitude===this.state.longitude||this.debouncedGetArticles()}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"App"},i.a.createElement("header",{className:"App-header"},"NEARME"),i.a.createElement("div",{className:"mapContainer"},i.a.createElement("div",{className:"mapInner"},this.renderIcon(),this.renderOverlay(),i.a.createElement(v,{style:"mapbox://styles/mapbox/dark-v10",containerStyle:{height:"100%",width:"100%"},center:[this.state.longitude,this.state.latitude],onMoveEnd:function(t){console.log("MOVED"),isNaN(t.transform._center.lat)||e.setState({latitude:t.transform._center.lat,longitude:t.transform._center.lng})}},i.a.createElement(m.b,{type:"symbol",id:"marker",layout:{"icon-image":"marker-15","icon-size":1.5}},this.state.items.map(function(t,n){return i.a.createElement(m.a,{key:t.pageId,coordinates:[t.longitude,t.latitude],onClick:function(){return e.setState({selectedItemIndex:n,menuOpen:!0},e.getArticleDetail)}})}))))))}},{key:"renderIcon",value:function(){var e=this;return i.a.createElement("a",{className:"menu",onClick:function(){return e.setState(function(e){return{menuOpen:!e.menuOpen,selectedItemIndex:-1}})}},this.state.menuOpen?i.a.createElement(f.b,null):i.a.createElement(f.a,{className:"menuOpen"}))}},{key:"renderOverlay",value:function(){if(this.state.menuOpen)return i.a.createElement("div",{className:"sidebar"},this.renderMenuContent())}},{key:"renderMenuContent",value:function(){var e=this.state.selectedItemIndex>=0;return i.a.createElement(i.a.Fragment,null,i.a.createElement("h5",null,e?this.state.items[this.state.selectedItemIndex].title:"Locations"),i.a.createElement("div",{className:"description"},e?this.renderItemDetails():this.renderItemNames()))}},{key:"renderItemDetails",value:function(){var e=this.state.items[this.state.selectedItemIndex].description;return e?i.a.createElement(i.a.Fragment,null,e.split("\n").map(function(e){return i.a.createElement("p",null,e)})):i.a.createElement("p",null,"No summary found")}},{key:"renderItemNames",value:function(){var e=this;return i.a.createElement("ul",null,this.state.items.map(function(t,n){return i.a.createElement("li",{key:t.pageId,className:"listItem",onClick:function(){return e.setState({selectedItemIndex:n},e.getArticleDetail)}},t.title)}))}},{key:"getArticleDetail",value:function(){var e=this;if(this.state.selectedItemIndex>=0){var t=this.state.items[this.state.selectedItemIndex];if(!t.description){var n=t.pageId,a="https://en.wikipedia.org/w/api.php?format=json&origin=*&action=query&prop=extracts&exintro&explaintext&redirects=1&pageids=".concat(n);h.a.get(a).then(function(t){e.setState(Object(I.a)(function(e){e.items[e.selectedItemIndex].description=t.data.query.pages[n].extract}))})}}}},{key:"getArticles",value:function(){var e=this,t="https://en.wikipedia.org/w/api.php?action=query&list=geosearch&gsradius=10000&gscoord=".concat(this.state.latitude,"|").concat(this.state.longitude,"&format=json&origin=*");h.a.get(t).then(function(t){var n=t.data.query.geosearch.map(function(e){return{latitude:e.lat,longitude:e.lon,pageId:e.pageid,title:e.title}});e.setState({items:n})})}}]),t}(i.a.Component);s.a.render(i.a.createElement(y,null),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.a860020e.chunk.js.map